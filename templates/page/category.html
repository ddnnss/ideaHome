{% extends 'basic.html' %}
{% load static %}
{% block content %}
<div class="main">
    <section class="catalog">
        <div class="container">
            <div class="catalog-wrapper">
                <div class="catalog-menu">
                    {% for cat in all_categories %}
                    <button id="{{ cat.name_slug }}" class="accordion">{{ cat.name }}</button>
                    <div class="panel">
                        <ul class="panel-list">
                            {% for subcat in cat.subcategory.all %}
                            <li class="panel-list-item"><a href="">{{ subcat.name }}</a></li>
                            {% endfor %}
                        </ul>
                    </div>
                    {% endfor %}


                </div><!--//catalog-menu-->
                <div class="catalog-items-wrapper">
                    <div class="catalog-items-filter">
                        <div class="dropdown">
                            <button onclick="customDropDown(this)" data-target="price" class="dropbtn">Сортировка</button>
                            <div id="price" class="dropdown-content">
                                <a href="#">Цена выше</a>
                                <a href="#">Цена ниже</a>
                            </div>
                        </div>
                        <div class="dropdown">
                            <button onclick="customDropDown(this)" data-target="category" class="dropbtn">Категория</button>
                            <div id="category" class="dropdown-content">
                                <a href="#">Цена выше</a>
                                <a href="#">Цена ниже</a>
                                <a href="#">Цена выше</a>
                                <a href="#">Цена ниже</a>
                            </div>
                        </div>
                        <div class="dropdown">
                            <button onclick="customDropDown(this)" data-target="brand" class="dropbtn">Производитель</button>
                            <div id="brand" class="dropdown-content">
                                {% for manufactor in manufactors %}
                                <a href="#">{{ manufactor.name }}</a>
                               {% endfor %}
                            </div>
                        </div>


                    </div><!--//catalog-items-filter-->
                    <div class="catalog-items-list">
                        {% for item in items %}
                        <div class="catalog-item">
                            <a href="#" class="catalog-item-fav-btn "><i class="fa fa-heart-o"></i></a>
                            <a class="catalog-item-image" href="#">
                              <img src="{{ item.get_small_image }}" alt="{{ item.name }}">
                            </a>
                            <a class="catalog-item-info" href="#">
                                <p>{{ item.name }}</p>
                                <span>Краткое описание товара. Нужно ли??</span>
                            </a>
                            <p class="catalog-item-price">{{ item.price }} <i class="fa fa-rub"></i></p>
                            <a href="#" class="btn catalog-item-btn">в корзину</a>
                        </div><!--//catalog-item-->
                        {% endfor %}
                    </div><!--//catalog-items-list-->
                </div><!--//catalog-items-wrapper-->
            </div><!--//catalog-wrapper-->


        </div><!--//container-->

    </section>
    <script>
        document.addEventListener("DOMContentLoaded", function(event) {
      document.getElementById('{{ category.name_slug }}').click()
});
    </script>
<script>
    let last_open=''
    function customDropDown(el) {

        let target = el.dataset.target
        if (last_open !=''){
            if (last_open === target){
                document.getElementById(target).classList.toggle("show");
                last_open=target
            }else{
                document.getElementById(last_open).classList.remove("show");
                document.getElementById(target).classList.toggle("show");
                last_open=target
            }


        }else{

            document.getElementById(target).classList.toggle("show");
            last_open=target
        }

    }

    // Close the dropdown if the user clicks outside of it
    window.onclick = function(event) {
        if (!event.target.matches('.dropbtn')) {
            var dropdowns = document.getElementsByClassName("dropdown-content");
            var i;
            for (i = 0; i < dropdowns.length; i++) {
                var openDropdown = dropdowns[i];
                if (openDropdown.classList.contains('show')) {
                    openDropdown.classList.remove('show');
                }
            }
        }
    }
</script>
</div><!--//main-->
{% endblock %}
